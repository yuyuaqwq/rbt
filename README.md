# rbt
空间开销更低的C++ `set`/`map`/`multiset`/`multimap` 红黑树容器

## 特性

-   每个节点的索引空间开销仅为**8 bytes**

    -   标准库实现是`8 * 3 + 1 = 25 bytes`，常见场景会对齐到**32 bytes**

    -   此时rbt的索引空间开销仅为STL的**1/4**

-   通常更快

    -   若`key`比较成本不会太高，则对红黑树性能影响最大的是`cache miss`
    -   小节点通常会有更好的表现

## 缺陷

-   迭代器较大
    -   需要一个固定大小的栈存储路径，`62 * 4 = 248 bytes` ，但它通常在栈上分配，因此可以忽略不计

-   向树中插入 或 从树中删除 节点，会使已存在的**迭代器失效**
    -   没有父节点，只能通过栈路径向上回溯

-   不支持自定义内存分配器
    -   使用了内存池来压缩指针
    -   仅有一个节点，也会分配`4096`字节的block
    -   一个容器中，最多存在`2,147,483,646`个节点
    -   释放的节点只能被内存池复用，无法被操作系统回收，除非清空整个容器

## 表现

